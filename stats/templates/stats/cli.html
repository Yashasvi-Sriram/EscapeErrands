{% extends 'errands/__base__.html' %}
{% block title %}Statistics{% endblock %}
{% block style %}
    <style>
        #command_read {
            font-family: monospace;
            font-size: x-large;
            margin-bottom: 0;
        }
    </style>
{% endblock %}
{% block body %}
    <script>
        var $command_read;
        var $command_print;
        /** Distinct keywords for all commands */
        var COMMANDS = [
            {
                keyword: "today",
                match: function (command_input) {
                    try {
                        if (this.keyword == command_input.split(" ")[0]) {
                            this.action(command_input);
                            return true;
                        }
                    }
                    catch (e) {
                    }
                    return false;
                },
                action: function (command_input) {
                    $($command_print).highcharts(
                        {
                            chart: {
                                zoomType: 'x',
                                spacingRight: 0
                            },
                            title: {
                                text: 'USD to EUR exchange rate from 2006 through 2008'
                            },
                            subtitle: {
                                text: document.ontouchstart === undefined ?
                                    'Click and drag in the plot area to zoom in' :
                                    'Drag your finger over the plot to zoom in'
                            },
                            xAxis: {
                                type: 'datetime',
                                tickInterval: 3600 * 1000,
                                title: {
                                    text: null
                                }
                            },
                            yAxis: {
                                title: {
                                    text: 'Exchange rate'
                                }
                            },
                            tooltip: {
                                shared: true
                            },
                            legend: {
                                enabled: false
                            },
                            plotOptions: {
                                area: {
                                    fillColor: {
                                        linearGradient: {x1: 0, y1: 0, x2: 0, y2: 1},
                                        stops: [
                                            [0, Highcharts.getOptions().colors[0]],
                                            [1, Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get('rgba')]
                                        ]
                                    },
                                    lineWidth: 1,
                                    marker: {
                                        enabled: false
                                    },
                                    shadow: false,
                                    states: {
                                        hover: {
                                            lineWidth: 1
                                        }
                                    },
                                    threshold: null
                                }
                            },
                            series: [
                                {
                                    type: 'area',
                                    name: 'USD to EUR',
                                    pointInterval: 3600 * 1000,
                                    pointStart: Date.UTC(2006, 0, 01, 0, 0, 0, 0),
                                    data: [
                                        0.8446, 0.8445, 0.8444, 0.8451
                                    ]
                                }
                            ]
                        }
                    );
                }
            }
        ];

        function REPL(event) {
            var command_input, command_index = -1;
            /** Read  ----------------------------------------------- */
            if (event.keyCode == 13) {
                command_input = $($command_read).val();
            }
            else return;
            /** Evaluate  ----------------------------------------------- */
            for (var i = 0; i < COMMANDS.length; ++i) {
                if (COMMANDS[i].match(command_input)) {
                    command_index = i;
                    break;
                }
            }
            /** Print  ----------------------------------------------- */
            // Command not available
            if (command_index == -1) {
                alert('Command not available')
            }
        }

        $(document).ready(function () {
            $command_read = $('#command_read');
            $command_print = $('#command_print');

            /**
             * REPL Listener
             * */
            $($command_read).keyup(function (event) {
                REPL(event);
            });
        });
    </script>

    <div class="container">
        <div class="row card hoverable">
            <div class="card-content input-field" style="margin: 0;">
                <span class="prefix">$:</span>
                <input id="command_read" type="text" autofocus>
            </div>
        </div>
        <br>
        <br>
        <br>
        <div class="row card hoverable">
            <div class="card-content">
                <div id="command_print" style="min-height: 60vh">

                </div>
            </div>
        </div>
    </div>
{% endblock %}